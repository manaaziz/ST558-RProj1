---
title: "ST558 Project I"
author: "Mana Azizsoltani"
date: "9/4/2020"
output: html_document
---

```{r setup, include=FALSE}
# Load necessary packages
library(knitr)
library(tidyverse)
library(parallel)
library(rmarkdown)
library(bigrquery)
library(DBI)
library(RSQLite)
library(httr)
library(jsonlite)
library(RCurl)
```


```{r}
cbind(data$franchiseId, data$franchiseName)
# Write URL to access the API
getRecords <- function(endpoint, id = NULL, team = NULL){
  base <- "https://records.nhl.com/site/api"
  table <- endpoint
  if (!is.null(team) & is.null(id)) {
    full_url <- full_url <- paste0(base, "/", table)
    data <- fromJSON(full_url, flatten = TRUE)$data %>% filter(franchiseName == team)
  } else if(!is.null(id) & is.null(team)) {
      full_url <- paste0(base, "/", table, "?cayenneExp=franchiseId=", id)
      data <-fromJSON(full_url, flatten = TRUE)$data
  } else if(is.null(id) & is.null(team)) {
      full_url <- paste0(base, "/", table)
      data <-fromJSON(full_url, flatten = TRUE)$data
    }
  return(data)
}

getStats <- function(modifier=NULL){
  base <- "https://statsapi.web.nhl.com/api/v1/teams"
  if(!is.null(modifier)){
    full_url <- paste0(base, modifier)
    data <- fromJSON(full_url, flatten = TRUE)$teams
  } else {
    data <- fromJSON(base, flatten = TRUE)$teams
  }
  return(data)
}


### TEST STUFF

full_url <- "https://statsapi.web.nhl.com/api/v1/teams?expand=person.names"
full_url <- "https://statsapi.web.nhl.com/api/v1/teams?expand=team.stats"
d <- fromJSON(full_url, flatten = TRUE)$teams


d <- getStats(modifier = "?expand=team.stats")

base <- "https://statsapi.web.nhl.com/api/v1/teams"
d <- fromJSON(full_url, flatten = TRUE)
  
base <- "https://records.nhl.com/site/api"
table <- "franchise"
attr <- "pikachu/"
full_url <- paste0(base, "/", table)
data <-fromJSON(full_url, flatten = TRUE)$data

table <-"franchise-team-totals"
full_url <- paste0(base, "/", table)
data <-fromJSON(full_url, flatten = TRUE)$data

table <- "franchise-season-records"
full_url <- paste0(base, "/", table)
data <-fromJSON(full_url, flatten = TRUE)$data %>% filter(franchiseName=="Vegas Golden Knights")

table <- "franchise-goalie-records"
full_url <- paste0(base, "/", table, "?cayenneExp=franchiseId=", id)
data <- fromJSON(full_url, flatten = TRUE)$data

table <- "franchise-season-records"
full_url <- paste0(base, "/", table, "?cayenneExp=franchiseId=", id)
data <-fromJSON(full_url, flatten = TRUE)$data

}
```